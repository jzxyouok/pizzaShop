{"version":3,"sources":["/site/shopadmin/goodstypeattr/goodstype.es"],"names":[],"mappings":"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","file":"/site/shopadmin/goodstypeattr/goodstype.es","sourcesContent":["/**\r\n * 模块相关操作\r\n * @method\r\n * @param  {[type]} function( [description]\r\n * @return {[type]}           [description]\r\n */\r\nlet goodstype = (function() {\r\n  let $ = require('jquery');\r\n  let tools = require('pizzatools');\r\n  let common = require('common/common');\r\n  let my = {};\r\n  let options = {\r\n    url: '/shopadmin/goodstype/',\r\n    tpl: __inline('../ejs/goodstype.ejs'),\r\n    cp: 1,\r\n    mp: 20\r\n  };\r\n  let isScroll = true;\r\n\r\n  /**\r\n   * 初始化执行函数\r\n   * @method function\r\n   * @return {[type]} [description]\r\n   */\r\n  my.init = function() {\r\n      eventBind(); //绑定所有交互操作\r\n      page(1); //\r\n      scrollEvent(); //绑定滚动条事件\r\n      common.checkAll('#checkall'); //checkall\r\n      common.kwSearch('#searchkw', function() {\r\n        page(1);\r\n      });\r\n    }\r\n    /**\r\n     * 编辑模块\r\n     * @method function\r\n     * @param  {[type]} obj [description]\r\n     * @return {[type]}     [description]\r\n     */\r\n  my.get = function() {\r\n      let id = tools.getPara(\"id\");\r\n      if (id == \"\") {\r\n        return;\r\n      }\r\n      $.ajax({\r\n        url: options.url + 'get',\r\n        data: 'id=' + id,\r\n        success: function(result) {\r\n          if (result.state == true) {\r\n            for (var key in result.msg) {\r\n              $('#' + key).val(result.msg[key]);\r\n            }\r\n          }\r\n        }\r\n      });\r\n    }\r\n    /**\r\n     * 编辑模块\r\n     * @method function\r\n     * @param  {[type]} obj [description]\r\n     * @return {[type]}     [description]\r\n     */\r\n  my.edit = function(obj) {\r\n      $(\".form\").pizzaValidate({\r\n        'fields': {\r\n          '#catname': {\r\n            'must': true,\r\n            'minLength': 1,\r\n            'maxLength': 20,\r\n            focusMsg: \"请输入商品类型名称\",\r\n            errMsg: '标题不能为空或标题必须在1-20个字符之间'\r\n          },\r\n        },\r\n        ajaxFun: function(data) {\r\n          let id = tools.getPara(\"id\");\r\n          let op = \"create\";\r\n          if (id != \"\") {\r\n            op = \"update\";\r\n            data += \"&id=\" + id;\r\n          }\r\n          $.ajax({\r\n            url: options.url + op,\r\n            data: data,\r\n            success: function(msg) {\r\n              if (msg.state == true) {\r\n                history.back();\r\n              }\r\n            }\r\n          });\r\n        }\r\n      });\r\n    }\r\n    /**\r\n     * 获取模块列表\r\n     * @method page\r\n     * @return {[type]} [description]\r\n     */\r\n  function page(cp, mp) {\r\n    if (cp) {\r\n      options.cp = cp;\r\n    }\r\n    $.ajax({\r\n      url: options.url + 'page',\r\n      data: 'cp=' + options.cp + '&mp=' + options.mp + '&kw=' + $.trim($('#searchkw').val()),\r\n      success: function(msg) {\r\n        let s = new EJS({text: options.tpl}).render({data: msg.msg});\r\n        if (cp == 1) {\r\n          $('#list').html(s);\r\n        } else {\r\n          $('#list').append(s);\r\n        }\r\n        options.cp += 1;\r\n        isScroll = true;\r\n      }\r\n    });\r\n  }\r\n  /**\r\n   * 操作事件绑定\r\n   * @method eventBind\r\n   * @return {[type]}  [description]\r\n   */\r\n  function eventBind() {\r\n    $('#list').on('click', 'li > span > i', function() {\r\n      let cl = $(this).attr('class');\r\n      console.log(cl);\r\n      if (cl) {\r\n        action[cl].call(this, $(this));\r\n      }\r\n    });\r\n    $('#main > div.menu').on('click', 'em', function() {\r\n      let cl = $(this).attr('class');\r\n      if (cl) {\r\n        action[cl].call(this, $(this));\r\n      }\r\n    });\r\n  }\r\n  /**\r\n   * 滚动条滚动事件\r\n   * @method scrollEvent\r\n   * @return {[type]}    [description]\r\n   */\r\n  function scrollEvent() {\r\n    $(window).scroll(function() {\r\n      let docHeight = document.body.scrollHeight;\r\n      let scrollTop = 0; //滚动条高度\r\n      if (document.documentElement && document.documentElement.scrollTop) {\r\n        scrollTop = document.documentElement.scrollTop;\r\n      } else if (document.body) {\r\n        scrollTop = document.body.scrollTop;\r\n      }\r\n      let bottomHeight = docHeight - scrollTop - $(window).height();\r\n      //console.log(bottomHeight);\r\n      //console.log(isScroll);\r\n      if (bottomHeight < 100 && isScroll == true) {\r\n        page();\r\n        isScroll = false;\r\n      }\r\n    });\r\n  }\r\n  /////action\r\n  let action = {};\r\n  /**\r\n   *\r\n   * @method remove\r\n   * @return {[type]} [description]\r\n   */\r\n  action.remove = function(obj) {\r\n    let id = common.getCheckId(obj);\r\n    console.log(id);\r\n    if (id == '0') {\r\n      return;\r\n    }\r\n    $.ajax({\r\n      url: options.url + 'remove',\r\n      data: 'id=' + id,\r\n      success: function(msg) {\r\n        if (msg.state == true) {\r\n          let ids = id.split(',');\r\n          for (var i = 0, ll = ids.length; i < ll; i++) {\r\n            $('#goodstype_' + ids[i]).parent().parent().remove();\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  return my;\r\n}());\r\n\r\nmodule.exports = goodstype;\r\n"]}